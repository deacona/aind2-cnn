from keras.callbacks import ModelCheckpoint   

batch_size = 32
epochs = 100

# train the model
checkpointer = ModelCheckpoint(filepath='aug_model.weights.best.hdf5', verbose=1, 
                               save_best_only=True)
model.fit_generator(datagen_train.flow(x_train, y_train, batch_size=batch_size),
                    steps_per_epoch=x_train.shape[0] // batch_size,
                    epochs=epochs, verbose=2, callbacks=[checkpointer],
                    validation_data=(x_valid, y_valid),
                    validation_steps=x_valid.shape[0] // batch_size)

Epoch 1/100
Epoch 00000: val_loss improved from inf to 1.23508, saving model to aug_model.weights.best.hdf5
83s - loss: 1.6383 - acc: 0.4059 - val_loss: 1.2351 - val_acc: 0.5574
Epoch 2/100
Epoch 00001: val_loss improved from 1.23508 to 1.15337, saving model to aug_model.weights.best.hdf5
82s - loss: 1.3232 - acc: 0.5289 - val_loss: 1.1534 - val_acc: 0.5836
Epoch 3/100
Epoch 00002: val_loss improved from 1.15337 to 1.04852, saving model to aug_model.weights.best.hdf5
81s - loss: 1.2280 - acc: 0.5638 - val_loss: 1.0485 - val_acc: 0.6212
Epoch 4/100
Epoch 00003: val_loss improved from 1.04852 to 1.00855, saving model to aug_model.weights.best.hdf5
87s - loss: 1.1698 - acc: 0.5874 - val_loss: 1.0085 - val_acc: 0.6466
Epoch 5/100
Epoch 00004: val_loss did not improve
84s - loss: 1.1523 - acc: 0.5981 - val_loss: 1.0606 - val_acc: 0.6240
Epoch 6/100
Epoch 00005: val_loss improved from 1.00855 to 0.92246, saving model to aug_model.weights.best.hdf5
84s - loss: 1.1354 - acc: 0.6049 - val_loss: 0.9225 - val_acc: 0.6920
Epoch 7/100
Epoch 00006: val_loss did not improve
83s - loss: 1.1325 - acc: 0.6103 - val_loss: 0.9489 - val_acc: 0.6728
Epoch 8/100
Epoch 00007: val_loss did not improve
85s - loss: 1.1269 - acc: 0.6138 - val_loss: 0.9552 - val_acc: 0.6706
Epoch 9/100
Epoch 00008: val_loss did not improve
87s - loss: 1.1396 - acc: 0.6127 - val_loss: 0.9416 - val_acc: 0.6752
Epoch 10/100
Epoch 00009: val_loss did not improve
83s - loss: 1.1418 - acc: 0.6091 - val_loss: 1.0035 - val_acc: 0.6656
Epoch 11/100
Epoch 00010: val_loss did not improve
81s - loss: 1.1548 - acc: 0.6064 - val_loss: 0.9475 - val_acc: 0.6724
Epoch 12/100
Epoch 00011: val_loss did not improve
88s - loss: 1.1707 - acc: 0.6021 - val_loss: 1.0449 - val_acc: 0.6808
Epoch 13/100
Epoch 00012: val_loss did not improve
81s - loss: 1.1861 - acc: 0.6015 - val_loss: 1.0145 - val_acc: 0.6590
Epoch 14/100
Epoch 00013: val_loss did not improve
81s - loss: 1.1993 - acc: 0.5983 - val_loss: 0.9752 - val_acc: 0.6694
Epoch 15/100
Epoch 00014: val_loss did not improve
82s - loss: 1.2173 - acc: 0.5895 - val_loss: 1.1353 - val_acc: 0.6140
Epoch 16/100
Epoch 00015: val_loss did not improve
82s - loss: 1.2426 - acc: 0.5821 - val_loss: 1.0562 - val_acc: 0.6460
Epoch 17/100
Epoch 00016: val_loss did not improve
83s - loss: 1.2573 - acc: 0.5781 - val_loss: 1.0468 - val_acc: 0.6444
Epoch 18/100
Epoch 00017: val_loss did not improve
83s - loss: 1.2741 - acc: 0.5712 - val_loss: 0.9935 - val_acc: 0.6714
Epoch 19/100
Epoch 00018: val_loss did not improve
81s - loss: 1.2942 - acc: 0.5679 - val_loss: 1.0730 - val_acc: 0.6558
Epoch 20/100
Epoch 00019: val_loss did not improve
84s - loss: 1.3112 - acc: 0.5624 - val_loss: 1.0884 - val_acc: 0.6290
Epoch 21/100
Epoch 00020: val_loss did not improve
84s - loss: 1.3390 - acc: 0.5528 - val_loss: 1.3686 - val_acc: 0.5966
Epoch 22/100
Epoch 00021: val_loss did not improve
84s - loss: 1.3436 - acc: 0.5522 - val_loss: 1.0461 - val_acc: 0.6478
Epoch 23/100
Epoch 00022: val_loss did not improve
85s - loss: 1.3661 - acc: 0.5432 - val_loss: 1.0516 - val_acc: 0.6446
Epoch 24/100
Epoch 00023: val_loss did not improve
87s - loss: 1.3668 - acc: 0.5422 - val_loss: 1.0217 - val_acc: 0.6556
Epoch 25/100
Epoch 00024: val_loss did not improve
85s - loss: 1.3920 - acc: 0.5360 - val_loss: 1.2145 - val_acc: 0.6302
Epoch 26/100
Epoch 00025: val_loss did not improve
85s - loss: 1.3990 - acc: 0.5317 - val_loss: 1.1457 - val_acc: 0.6112
Epoch 27/100
Epoch 00026: val_loss did not improve
83s - loss: 1.4191 - acc: 0.5276 - val_loss: 1.3490 - val_acc: 0.5736
Epoch 28/100
Epoch 00027: val_loss did not improve
85s - loss: 1.4353 - acc: 0.5213 - val_loss: 1.1113 - val_acc: 0.6270
Epoch 29/100
Epoch 00028: val_loss did not improve
84s - loss: 1.4509 - acc: 0.5155 - val_loss: 1.0981 - val_acc: 0.6234
Epoch 30/100
Epoch 00029: val_loss did not improve
84s - loss: 1.4735 - acc: 0.5080 - val_loss: 1.1134 - val_acc: 0.6266
Epoch 31/100
Epoch 00030: val_loss did not improve
84s - loss: 1.4840 - acc: 0.5058 - val_loss: 1.2241 - val_acc: 0.5734
Epoch 32/100
Epoch 00031: val_loss did not improve
83s - loss: 1.4971 - acc: 0.4964 - val_loss: 1.2141 - val_acc: 0.5896
Epoch 33/100
Epoch 00032: val_loss did not improve
83s - loss: 1.5058 - acc: 0.4919 - val_loss: 1.1250 - val_acc: 0.6178
Epoch 34/100
Epoch 00033: val_loss did not improve
84s - loss: 1.5204 - acc: 0.4845 - val_loss: 1.1628 - val_acc: 0.6112
Epoch 35/100
Epoch 00034: val_loss did not improve
83s - loss: 1.5454 - acc: 0.4769 - val_loss: 1.2698 - val_acc: 0.5736
Epoch 36/100
Epoch 00035: val_loss did not improve
88s - loss: 1.5618 - acc: 0.4734 - val_loss: 1.2392 - val_acc: 0.5798
Epoch 37/100
Epoch 00036: val_loss did not improve
101s - loss: 1.5593 - acc: 0.4760 - val_loss: 1.4303 - val_acc: 0.5670
Epoch 38/100
Epoch 00037: val_loss did not improve
100s - loss: 1.5742 - acc: 0.4687 - val_loss: 1.3318 - val_acc: 0.5398
Epoch 39/100
Epoch 00038: val_loss did not improve
99s - loss: 1.5871 - acc: 0.4652 - val_loss: 1.2699 - val_acc: 0.5772
Epoch 40/100
Epoch 00039: val_loss did not improve
98s - loss: 1.5839 - acc: 0.4682 - val_loss: 1.2914 - val_acc: 0.5900
Epoch 41/100
Epoch 00040: val_loss did not improve
98s - loss: 1.6036 - acc: 0.4597 - val_loss: 1.2749 - val_acc: 0.5538
Epoch 42/100
Epoch 00041: val_loss did not improve
94s - loss: 1.5949 - acc: 0.4569 - val_loss: 1.2586 - val_acc: 0.5678
Epoch 43/100
Epoch 00042: val_loss did not improve
123s - loss: 1.6125 - acc: 0.4478 - val_loss: 1.2826 - val_acc: 0.5828
Epoch 44/100
Epoch 00043: val_loss did not improve
121s - loss: 1.6477 - acc: 0.4410 - val_loss: 1.4376 - val_acc: 0.5108
Epoch 45/100
Epoch 00044: val_loss did not improve
100s - loss: 1.6443 - acc: 0.4394 - val_loss: 1.4483 - val_acc: 0.4906
Epoch 46/100
Epoch 00045: val_loss did not improve
93s - loss: 1.6420 - acc: 0.4359 - val_loss: 1.6339 - val_acc: 0.4808
Epoch 47/100
Epoch 00046: val_loss did not improve
89s - loss: 1.6552 - acc: 0.4373 - val_loss: 1.3701 - val_acc: 0.5158
Epoch 48/100
Epoch 00047: val_loss did not improve
88s - loss: 1.6567 - acc: 0.4373 - val_loss: 1.5040 - val_acc: 0.4560
Epoch 49/100
Epoch 00048: val_loss did not improve
94s - loss: 1.6752 - acc: 0.4233 - val_loss: 1.4592 - val_acc: 0.4844
Epoch 50/100
Epoch 00049: val_loss did not improve
91s - loss: 1.7035 - acc: 0.4153 - val_loss: 1.5781 - val_acc: 0.4164
Epoch 51/100
Epoch 00050: val_loss did not improve
91s - loss: 1.7187 - acc: 0.4137 - val_loss: 1.4240 - val_acc: 0.5004
Epoch 52/100
Epoch 00051: val_loss did not improve
90s - loss: 1.7328 - acc: 0.4038 - val_loss: 1.4348 - val_acc: 0.5036
Epoch 53/100
Epoch 00052: val_loss did not improve
91s - loss: 1.7355 - acc: 0.4036 - val_loss: 1.4686 - val_acc: 0.4884
Epoch 54/100
Epoch 00053: val_loss did not improve
91s - loss: 1.7520 - acc: 0.3896 - val_loss: 1.4791 - val_acc: 0.4878
Epoch 55/100
Epoch 00054: val_loss did not improve
91s - loss: 1.7533 - acc: 0.3982 - val_loss: 1.4827 - val_acc: 0.4806
Epoch 56/100
Epoch 00055: val_loss did not improve
91s - loss: 1.7617 - acc: 0.3951 - val_loss: 1.4868 - val_acc: 0.4510
Epoch 57/100
Epoch 00056: val_loss did not improve
90s - loss: 1.7619 - acc: 0.3947 - val_loss: 1.5159 - val_acc: 0.4548
Epoch 58/100
Epoch 00057: val_loss did not improve
91s - loss: 1.7695 - acc: 0.3827 - val_loss: 1.4768 - val_acc: 0.4544
Epoch 59/100
Epoch 00058: val_loss did not improve
89s - loss: 1.7702 - acc: 0.3873 - val_loss: 1.5027 - val_acc: 0.4872
Epoch 60/100
Epoch 00059: val_loss did not improve
91s - loss: 1.7869 - acc: 0.3764 - val_loss: 1.5189 - val_acc: 0.4886
Epoch 61/100
Epoch 00060: val_loss did not improve
93s - loss: 1.7967 - acc: 0.3739 - val_loss: 1.5767 - val_acc: 0.4152
Epoch 62/100
Epoch 00061: val_loss did not improve
89s - loss: 1.7843 - acc: 0.3752 - val_loss: 1.4429 - val_acc: 0.4938
Epoch 63/100
Epoch 00062: val_loss did not improve
90s - loss: 1.8100 - acc: 0.3679 - val_loss: 1.9240 - val_acc: 0.3984
Epoch 64/100
Epoch 00063: val_loss did not improve
90s - loss: 1.8065 - acc: 0.3664 - val_loss: 1.5186 - val_acc: 0.4632
Epoch 65/100
Epoch 00064: val_loss did not improve
91s - loss: 1.8114 - acc: 0.3711 - val_loss: 1.6172 - val_acc: 0.4262
Epoch 66/100
Epoch 00065: val_loss did not improve
92s - loss: 1.7982 - acc: 0.3655 - val_loss: 1.6804 - val_acc: 0.3862
Epoch 67/100
Epoch 00066: val_loss did not improve
92s - loss: 1.8146 - acc: 0.3627 - val_loss: 1.4919 - val_acc: 0.4700
Epoch 68/100
Epoch 00067: val_loss did not improve
92s - loss: 1.8119 - acc: 0.3551 - val_loss: 1.5869 - val_acc: 0.4340
Epoch 69/100
Epoch 00068: val_loss did not improve
91s - loss: 1.8198 - acc: 0.3545 - val_loss: 1.5474 - val_acc: 0.4716
Epoch 70/100
Epoch 00069: val_loss did not improve
92s - loss: 1.8238 - acc: 0.3540 - val_loss: 1.6201 - val_acc: 0.4558
Epoch 71/100
Epoch 00070: val_loss did not improve
93s - loss: 1.8203 - acc: 0.3596 - val_loss: 1.8461 - val_acc: 0.3364
Epoch 72/100
Epoch 00071: val_loss did not improve
90s - loss: 1.8307 - acc: 0.3511 - val_loss: 1.6331 - val_acc: 0.4368
Epoch 73/100
Epoch 00072: val_loss did not improve
93s - loss: 1.8549 - acc: 0.3502 - val_loss: 1.5489 - val_acc: 0.4392
Epoch 74/100
Epoch 00073: val_loss did not improve
92s - loss: 1.8501 - acc: 0.3433 - val_loss: 1.7892 - val_acc: 0.4330
Epoch 75/100
Epoch 00074: val_loss did not improve
95s - loss: 1.8474 - acc: 0.3431 - val_loss: 1.5733 - val_acc: 0.4444
Epoch 76/100
Epoch 00075: val_loss did not improve
93s - loss: 1.8541 - acc: 0.3438 - val_loss: 2.2311 - val_acc: 0.3502
Epoch 77/100
Epoch 00076: val_loss did not improve
94s - loss: 1.8625 - acc: 0.3418 - val_loss: 1.7047 - val_acc: 0.3826
Epoch 78/100
Epoch 00077: val_loss did not improve
89s - loss: 1.8411 - acc: 0.3436 - val_loss: 1.7293 - val_acc: 0.3786
Epoch 79/100
Epoch 00078: val_loss did not improve
89s - loss: 1.8521 - acc: 0.3402 - val_loss: 1.5964 - val_acc: 0.4134
Epoch 80/100
Epoch 00079: val_loss did not improve
87s - loss: 1.8401 - acc: 0.3393 - val_loss: 1.6174 - val_acc: 0.3572
Epoch 81/100
Epoch 00080: val_loss did not improve
92s - loss: 1.8664 - acc: 0.3327 - val_loss: 1.7229 - val_acc: 0.3538
Epoch 82/100
Epoch 00081: val_loss did not improve
92s - loss: 1.8747 - acc: 0.3331 - val_loss: 1.5862 - val_acc: 0.4054
Epoch 83/100
Epoch 00082: val_loss did not improve
89s - loss: 1.8798 - acc: 0.3231 - val_loss: 1.7279 - val_acc: 0.3466
Epoch 84/100
Epoch 00083: val_loss did not improve
91s - loss: 1.8890 - acc: 0.3228 - val_loss: 1.7154 - val_acc: 0.3734
Epoch 85/100
Epoch 00084: val_loss did not improve
94s - loss: 1.9114 - acc: 0.3151 - val_loss: 1.7212 - val_acc: 0.3626
Epoch 86/100
Epoch 00085: val_loss did not improve
91s - loss: 1.8691 - acc: 0.3188 - val_loss: 1.6434 - val_acc: 0.3756
Epoch 87/100
Epoch 00086: val_loss did not improve
90s - loss: 1.8925 - acc: 0.3122 - val_loss: 1.6369 - val_acc: 0.4036
Epoch 88/100
Epoch 00087: val_loss did not improve
89s - loss: 1.8856 - acc: 0.3127 - val_loss: 1.6837 - val_acc: 0.3718
Epoch 89/100
Epoch 00088: val_loss did not improve
97s - loss: 1.8865 - acc: 0.3125 - val_loss: 1.7388 - val_acc: 0.3524
Epoch 90/100
Epoch 00089: val_loss did not improve
92s - loss: 1.8898 - acc: 0.3098 - val_loss: 1.8105 - val_acc: 0.3614
Epoch 91/100
Epoch 00090: val_loss did not improve
97s - loss: 1.8957 - acc: 0.3104 - val_loss: 1.6756 - val_acc: 0.3810
Epoch 92/100
Epoch 00091: val_loss did not improve
90s - loss: 1.9150 - acc: 0.3060 - val_loss: 1.6688 - val_acc: 0.3838
Epoch 93/100
Epoch 00092: val_loss did not improve
87s - loss: 1.9103 - acc: 0.3003 - val_loss: 1.7308 - val_acc: 0.3622
Epoch 94/100
Epoch 00093: val_loss did not improve
97s - loss: 1.9383 - acc: 0.2907 - val_loss: 1.7762 - val_acc: 0.3376
Epoch 95/100
Epoch 00094: val_loss did not improve
97s - loss: 1.9314 - acc: 0.2926 - val_loss: 1.9121 - val_acc: 0.3000
Epoch 96/100
Epoch 00095: val_loss did not improve
98s - loss: 1.9525 - acc: 0.2919 - val_loss: 1.6804 - val_acc: 0.3690
Epoch 97/100
Epoch 00096: val_loss did not improve
100s - loss: 1.9356 - acc: 0.2945 - val_loss: 1.9011 - val_acc: 0.3642
Epoch 98/100
Epoch 00097: val_loss did not improve
97s - loss: 1.9462 - acc: 0.2873 - val_loss: 1.7618 - val_acc: 0.3722
Epoch 99/100
Epoch 00098: val_loss did not improve
97s - loss: 1.9474 - acc: 0.2866 - val_loss: 1.7884 - val_acc: 0.3130
Epoch 100/100
Epoch 00099: val_loss did not improve
96s - loss: 1.9693 - acc: 0.2848 - val_loss: 1.6976 - val_acc: 0.3452

<keras.callbacks.History at 0x3a92a9a080>